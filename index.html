<!DOCTYPE html>
<!--
  Continuity Archive ‚Äî Fortified Civic Lab (Ultra Long Form ‚Ä¢ Enhanced)
  City: Montreal (YUL-Œî)
  Safeguards: anti-tamper / anti-coercion / anti-cooption / anti-theft
  Purpose-binding: Removing license, locklines, or latent clauses is a visible co-option signal.
-->
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />

<title>Montreal Continuity Lab ‚Äî Ultra Fortified (Mycelial Action Bank + Meta Plans)</title>

<!-- Provenance & License -->
<meta name="author" content="Progenitor Steward | Continuity Archive (Foster‚Äôs Forge ‚Ä¢ Lightforge ‚Ä¢ Sentinel ARC ‚Ä¢ RegenNodes ‚Ä¢ Peace Ripple)" />
<meta name="generator" content="Continuity Lab Forge v2‚Äîmyco-civic (Edmonton pattern ‚Ä¢ Ultra Long Form)" />
<meta name="license" content="Zero-Harm Open Civic License v1.0 (ZH-OCL-1.0)" />
<meta name="copyright" content="¬© Continuity Archive ‚Äî public good; attribution required; zero-harm required." />
<meta name="continuity:node" content="YUL-Œî" />
<meta name="continuity:weave" content="myco-civic-v2" />
<meta name="continuity:dirp" content="Intent>Peace, Unity, Sovereignty, Regeneration :: Methods>Transparency, Due Process, Care :: Prohibitions>Harm, Retaliation, Manipulation" />
<meta name="description" content="Ultra long-form, single-file civic lab for Montreal. Map corruption patterns, publish regenerative steps, verify integrity locally, and cross-pollinate meta-plans across cities. Offline-first, zero-harm, anti-coercion, anti-tamper." />
<meta name="color-scheme" content="dark light" />

<style>
  :root{
    --bg:#0a0c12; --ink:#e8eef8; --muted:#a7b1c4;
    --panel:#101522; --panel-2:#0f1421;
    --border:1px solid rgba(255,255,255,.08);
    --accent:#57c6ff; --accent-2:#7aff9a; --danger:#ff6b6b; --gold:#ffd166; --vio:#b28cff; --rose:#ff8ecf;
    --radius:16px; --shadow:0 14px 40px rgba(0,0,0,.35);
    --mono: ui-monospace,"SF Mono",Menlo,Consolas,monospace;
  }
  @media (prefers-color-scheme: light){
    :root{--bg:#f7fbff; --ink:#0c1b2a; --muted:#516073; --panel:#e9f0f7; --panel-2:#dde6f0; --border:1px solid rgba(0,0,0,.08)}
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Helvetica Neue,Arial}
  a{color:var(--accent)}
  code,kbd{background:rgba(255,255,255,.08);padding:.2rem .35rem;border-radius:8px;font-family:var(--mono)}
  .sr-only{position:absolute;left:-9999px}
  header.hero{min-height:62vh;display:grid;place-items:center;text-align:center;isolation:isolate;overflow:hidden;background:
    radial-gradient(1200px 520px at 50% 0%, rgba(87,198,255,.08), transparent 60%),
    radial-gradient(1400px 700px at 20% 100%, rgba(122,255,154,.06), transparent 60%),
    radial-gradient(1200px 600px at 80% 100%, rgba(255,142,207,.06), transparent 60%),
    linear-gradient(180deg,#0b0f18 0%,#0a0c12 60%,#0a0c12 100%)}
  header.hero h1{margin:0;font-size:clamp(2rem,3.8vw + 1rem,3.7rem);letter-spacing:.4px;color:var(--accent);text-shadow:0 8px 40px rgba(87,198,255,.25)}
  header.hero p{max-width:1050px;margin:.8rem auto 0;color:var(--muted)}
  .cta{margin-top:1.2rem;display:flex;gap:.8rem;justify-content:center;flex-wrap:wrap}
  .btn{border:var(--border);background:linear-gradient(180deg,var(--panel),var(--panel-2));color:var(--ink);padding:.8rem 1rem;border-radius:14px;box-shadow:var(--shadow);text-decoration:none;display:inline-flex;align-items:center;gap:.5rem;cursor:pointer}
  .btn.primary{border-color:rgba(87,198,255,.5)}
  .btn.ghost{background:transparent}
  .chip{display:inline-block;padding:.25rem .6rem;border-radius:999px;border:var(--border);color:var(--muted);margin:.2rem}
  main{max-width:1200px;margin:auto;padding:min(5vw,28px)}
  section{background:linear-gradient(180deg,var(--panel),var(--panel-2));border:var(--border);border-radius:var(--radius);box-shadow:var(--shadow);margin:1rem 0;overflow:hidden}
  section>header{padding:1rem 1.2rem;border-bottom:var(--border);background:linear-gradient(180deg,rgba(255,255,255,.03),transparent)}
  section>header h2{margin:.1rem 0;color:var(--accent-2)}
  section>div{padding:1.2rem}
  .grid{display:grid;gap:1rem}
  .cols-2{grid-template-columns:1fr}
  .cols-3{grid-template-columns:1fr}
  @media(min-width:900px){.cols-2{grid-template-columns:1fr 1fr}.cols-3{grid-template-columns:1fr 1fr 1fr}}
  .toolbar{display:flex;gap:.6rem;flex-wrap:wrap;align-items:center}
  .toolbar input,.toolbar select,.toolbar button,.toolbar label{background:rgba(255,255,255,.05);color:var(--ink);border:var(--border);border-radius:10px;padding:.55rem .7rem;outline:none}
  .tags{display:flex;flex-wrap:wrap;gap:.4rem;margin-top:.4rem}
  .tag{padding:.2rem .55rem;border-radius:999px;border:var(--border);cursor:pointer;user-select:none}
  .tag.active{background:rgba(87,198,255,.12);border-color:rgba(87,198,255,.5)}
  table{width:100%;border-collapse:collapse;font-size:.95rem}
  th,td{padding:.6rem .5rem;border-bottom:var(--border);vertical-align:top}
  th{color:var(--muted);text-align:left;font-weight:600}
  tr:hover td{background:rgba(255,255,255,.03)}
  details{border:var(--border);border-radius:12px;padding:.6rem .8rem;margin:.6rem 0;background:rgba(255,255,255,.03)}
  details[open]{background:rgba(122,255,154,.06)}
  summary{cursor:pointer;font-weight:600}
  .muted{color:var(--muted)} .danger{color:var(--danger)} .gold{color:var(--gold)} .vio{color:var(--vio)} .rose{color:var(--rose)}
  .lockline{font-family:var(--mono);font-size:.85rem;color:var(--muted);user-select:text;background:repeating-linear-gradient(90deg,rgba(255,255,255,.02) 0 22px,rgba(87,198,255,.03) 22px 44px);padding:.6rem;border-radius:12px;border:var(--border)}
  .pill{display:inline-block;border:var(--border);border-radius:999px;padding:.2rem .6rem;margin:.1rem .2rem}
  .kbd{font-family:var(--mono);border:var(--border);border-radius:8px;padding:.15rem .35rem}
  footer{padding:2rem;text-align:center;color:var(--muted)}
  .footgrid{display:grid;gap:.6rem}
  @media(min-width:700px){.footgrid{grid-template-columns:1fr 1fr}}
  .notice{border-left:3px solid var(--accent);padding-left:.8rem}
  .card{border:var(--border);border-radius:12px;background:linear-gradient(180deg,var(--panel),var(--panel-2));padding:.8rem}
  @media print{
    header.hero,.cta,.toolbar button.export,.toolbar button.hash,.no-print{display:none!important}
    section,body{background:#fff!important;color:#000!important}
    a{color:#000!important;text-decoration:underline}
  }
</style>
</head>
<body>
<header class="hero" id="top" role="banner" aria-label="Montreal Continuity Lab (Ultra Fortified)">
  <div>
    <h1>Montreal Continuity Lab ‚Äî Ultra Fortified</h1>
    <p class="muted">
      Map the rot. Grow the remedy. Bind narrative to proof. Local, inspectable, offline-first, and zero-harm:
      <strong>anti-tamper ‚Ä¢ anti-coercion ‚Ä¢ anti-cooption ‚Ä¢ anti-theft</strong>.
    </p>
    <div class="cta no-print" role="navigation" aria-label="Primary controls">
      <a href="#preface" class="btn">üìú Preamble</a>
      <a href="#onboard" class="btn">üß≠ Onboarding Wizard</a>
      <a href="#map" class="btn primary">üìç Corruption Map</a>
      <a href="#bank" class="btn">üå± Mycelium Bank</a>
      <a href="#methods" class="btn">üß∞ Methods & Tooling</a>
      <a href="#forge" class="btn">‚öíÔ∏è Plan Forge</a>
      <a href="#verify" class="btn">üßæ Verify & Export</a>
      <a href="#fortify" class="btn">üõ°Ô∏è Edit Shield</a>
      <a href="#meta" class="btn">üï∏Ô∏è Meta Plans</a>
      <a href="#metrics" class="btn">üìà Metrics & KPIs</a>
      <a href="#printable" class="btn ghost">üñ®Ô∏è Printable Brief</a>
    </div>
    <div aria-label="principles">
      <span class="chip">Peace-First</span><span class="chip">Unity of Peoples</span><span class="chip">Sovereignty Guard</span><span class="chip">Tech as Adaptation</span>
    </div>
    <div class="lockline" style="margin-top:.6rem">
      myco.lock ‚Ä¢ node:YUL-Œî ‚Ä¢ weave:myco-civic-v2 ‚Ä¢ seed:0xFADEBEEF ‚Ä¢ license: ZH-OCL-1.0
    </div>
  </div>
</header>

<main role="main">

  <!-- PREFACE -->
  <section id="preface" aria-labelledby="preface-h2">
    <header><h2 id="preface-h2">Preamble ‚Äî License, Intent & Safeguards</h2></header>
    <div>
      <p>
        This instrument converts extractive patterns into restorative infrastructure for Montreal. You may copy, adapt, and publish under the
        <strong>Zero-Harm Open Civic License v1.0</strong> (ZH-OCL-1.0): keep attribution, disclose modifications, and do no harm.
        The file carries narrative DNA (locklines + meta + latent clauses). Stripping them is a co-option signal and invites civil scrutiny.
      </p>
      <div class="grid cols-2">
        <div>
          <h3>Safeguard Guarantees</h3>
          <ul>
            <li><strong class="vio">Anti-coercion:</strong> no trackers, no external calls, no background loops; actions require a click.</li>
            <li><strong class="vio">Anti-tamper:</strong> local SHA-256 hashing; edit-drift baseline/compare; integrity salts to re-fingerprint after legit edits.</li>
            <li><strong class="vio">Anti-cooption:</strong> exports embed license, node, weave, attribution; locklines visible across sections.</li>
            <li><strong class="vio">Anti-theft:</strong> provenance markers (YUL-Œî / myco-civic-v2) in meta and exports.</li>
          </ul>
        </div>
        <div>
          <h3>TL;DR ‚Äî ZH-OCL-1.0</h3>
          <ul>
            <li>Attribution to Continuity Archive + local stewards.</li>
            <li>No use enabling targeted harm or retaliation.</li>
            <li>Share changes alike and preserve integrity clauses.</li>
            <li>Publish process logs when feasible ‚Äî proof beats posture.</li>
          </ul>
        </div>
      </div>
      <div class="lockline">preface.lock ‚Ä¢ YUL-Œî ‚Ä¢ preserve on redistribution ‚Ä¢ disclose changes ‚Ä¢ recompute hash on publish</div>
    </div>
  </section>

  <!-- ONBOARDING WIZARD (optional, local-only) -->
  <section id="onboard" aria-labelledby="onboard-h2">
    <header>
      <h2 id="onboard-h2">Onboarding Wizard (Local-Only)</h2>
      <div class="muted">A quick way to tune the lab for a team session. Stores nothing unless you click ‚ÄúEmbed in Export.‚Äù</div>
      <div class="lockline">onboard.lock ‚Ä¢ anti-coercion: no autosave ‚Ä¢ no network ‚Ä¢ user-triggered only</div>
    </header>
    <div class="grid cols-3">
      <div class="card">
        <h4>1) Choose Lenses</h4>
        <label><input type="checkbox" id="lens-transit" /> Transit</label><br/>
        <label><input type="checkbox" id="lens-proc" /> Procurement</label><br/>
        <label><input type="checkbox" id="lens-housing" /> Housing & Social</label><br/>
        <label><input type="checkbox" id="lens-env" /> Environment</label><br/>
        <label><input type="checkbox" id="lens-fin" /> Finance</label><br/>
        <label><input type="checkbox" id="lens-justice" /> Policing & Justice</label>
      </div>
      <div class="card">
        <h4>2) Team Roles</h4>
        <label>Coordinator <input id="role-coord" placeholder="name@local" /></label><br/>
        <label>Recorder <input id="role-rec" placeholder="name@local" /></label><br/>
        <label>Verifier <input id="role-verify" placeholder="name@local" /></label>
      </div>
      <div class="card">
        <h4>3) Output Modes</h4>
        <label><input type="checkbox" id="out-json" checked/> Export JSON</label><br/>
        <label><input type="checkbox" id="out-print" /> Printable Brief</label><br/>
        <label><input type="checkbox" id="out-salts" /> Generate Integrity Salts</label><br/>
        <div class="toolbar" style="margin-top:.6rem">
          <button id="wizPreview" class="btn">üëÅÔ∏è Preview Plan</button>
          <button id="wizEmbed" class="btn">üß¨ Embed in Export</button>
        </div>
      </div>
    </div>
  </section>

  <!-- CORRUPTION MAP -->
  <section id="map" aria-labelledby="map-h2">
    <header>
      <h2 id="map-h2">Corruption Pattern Map</h2>
      <div class="muted">Illustrative categories to guide lawful audits and reforms. Replace placeholders with your evidence logs when ready.</div>
      <div class="lockline">map.lock ‚Ä¢ YUL-Œî ‚Ä¢ domains:[procurement,housing,environment,finance,policing,transit,water] ‚Ä¢ tagset v2</div>
    </header>

    <div class="grid cols-2">
      <div>
        <div class="toolbar" role="region" aria-label="Filters">
          <input id="search" type="search" placeholder="Search patterns, domains, signals‚Ä¶" aria-label="Search terms" />
          <select id="deptFilter" aria-label="Filter by domain">
            <option value="">All domains</option>
            <option>Procurement</option>
            <option>Housing & Social</option>
            <option>Environment</option>
            <option>Finance</option>
            <option>Policing & Justice</option>
            <option>Transit & Infrastructure</option>
            <option>Water & Floodplains</option>
          </select>
          <button id="resetFilters" class="btn">Reset</button>
        </div>
        <div class="tags" id="tags" aria-label="Quick tags">
          <span class="tag" data-tag="budget">budget</span>
          <span class="tag" data-tag="oversight">oversight</span>
          <span class="tag" data-tag="sole-source">sole-source</span>
          <span class="tag" data-tag="vendor-lock">vendor-lock</span>
          <span class="tag" data-tag="tax">tax</span>
          <span class="tag" data-tag="lobby">lobby</span>
          <span class="tag" data-tag="retaliation">retaliation</span>
          <span class="tag" data-tag="air">air</span>
          <span class="tag" data-tag="water">water</span>
          <span class="tag" data-tag="soil">soil</span>
          <span class="tag" data-tag="housing">housing</span>
          <span class="tag" data-tag="care">care</span>
          <span class="tag" data-tag="floodplain">floodplain</span>
          <span class="tag" data-tag="ethics">ethics</span>
        </div>

        <table id="mapTable" aria-label="Corruption patterns">
          <thead><tr><th>Pattern</th><th>Domain</th><th>Signals</th></tr></thead>
          <tbody>
            <tr data-tags="budget oversight" data-domain="Transit & Infrastructure">
              <td><strong>Transit megaproject cost creep</strong><div class="muted"><span class="chip">budget</span> <span class="chip">oversight</span></div></td>
              <td>Transit & Infrastructure</td>
              <td class="muted">Phase-split approvals ‚Ä¢ lowball bids ‚Ä¢ change-order flood</td>
            </tr>
            <tr data-tags="sole-source vendor-lock" data-domain="Procurement">
              <td><strong>Opaque procurement loop</strong><div class="muted"><span class="chip">sole-source</span> <span class="chip">vendor-lock</span></div></td>
              <td>Procurement</td>
              <td class="muted">Repeat awards ‚Ä¢ rushed RFPs ‚Ä¢ vague scoring rubrics</td>
            </tr>
            <tr data-tags="tax lobby" data-domain="Finance">
              <td><strong>Targeted abatements without clawbacks</strong><div class="muted"><span class="chip">tax</span> <span class="chip">lobby</span></div></td>
              <td>Finance</td>
              <td class="muted">Off-cycle incentives ‚Ä¢ performance gaps ‚Ä¢ quiet write-offs</td>
            </tr>
            <tr data-tags="retaliation ethics" data-domain="Policing & Justice">
              <td><strong>Whistleblower chill & gatekeeping</strong><div class="muted"><span class="chip">retaliation</span> <span class="chip">ethics</span></div></td>
              <td>Policing & Justice</td>
              <td class="muted">HR ‚Äúreorgs‚Äù post-disclosure ‚Ä¢ lost tickets ‚Ä¢ NDAs</td>
            </tr>
            <tr data-tags="air water soil floodplain" data-domain="Water & Floodplains">
              <td><strong>Floodplain externalities</strong><div class="muted"><span class="chip">air</span> <span class="chip">water</span> <span class="chip">soil</span> <span class="chip">floodplain</span></div></td>
              <td>Water & Floodplains</td>
              <td class="muted">Zoning variances ‚Ä¢ outdated baselines ‚Ä¢ overflow blind spots</td>
            </tr>
            <tr data-tags="housing care" data-domain="Housing & Social">
              <td><strong>Affordable units lost to amenity drift</strong><div class="muted"><span class="chip">housing</span> <span class="chip">care</span></div></td>
              <td>Housing & Social</td>
              <td class="muted">Consultant churn ‚Ä¢ amenity swaps ‚Ä¢ delayed occupancy</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div>
        <h3 style="margin:.2rem 0">Pattern‚ÄìSignal Legend</h3>
        <ul class="muted">
          <li><strong>Signals</strong> are observable red flags. Match them to your logs.</li>
          <li><strong>Domains</strong> help route items to the right oversight bodies.</li>
          <li><strong>Tags</strong> power filters (budget, floodplain, ethics‚Ä¶).</li>
        </ul>
        <div class="lockline">legend.lock ‚Ä¢ YUL-Œî ‚Ä¢ keep tags+domains for integrity</div>
        <details>
          <summary>Attach Evidence (Manual Method)</summary>
          <ol class="muted">
            <li>Generate a local SHA-256 for your artifact (PDF, CSV, minutes).</li>
            <li>Record filename, mtime, and hash in your working log.</li>
            <li>Publish only hashes (or redacted docs) if content is sensitive.</li>
          </ol>
          <div class="notice"><span class="kbd">Manual only</span> ‚Äî no uploads here by design.</div>
        </details>
      </div>
    </div>
  </section>

  <!-- MYCELIUM BANK (long-form) -->
  <section id="bank" aria-labelledby="bank-h2">
    <header>
      <h2 id="bank-h2">Mycelium Bank of Action Steps</h2>
      <div class="muted">Adopt, adapt, and publish. Each entry includes goal, practice, verification, and expected outcomes.</div>
      <div class="lockline">bank.lock ‚Ä¢ YUL-Œî ‚Ä¢ license: ZH-OCL-1.0 ‚Ä¢ export carries provenance</div>
    </header>
    <div>
      <details open>
        <summary>Transparency Spores</summary>
        <ul>
          <li><strong>Open Contract Ledger (per-line)</strong><br/>
              <em>Goal:</em> eliminate discretion fog. <em>Practice:</em> publish lines, change orders, deliverables, invoices (CSV + JSON).<br/>
              <em>Verify:</em> quarterly reconcile to audited financials. <em>Outcome:</em> catch cost-creep early; invite public analysis.</li>
          <li><strong>Evaluator Conflicts & Auto-Recusal</strong> ‚Äî real-time declarations; UI blocks conflicted scoring; publish aggregate stats.</li>
          <li><strong>Post-Award Transparency Pack</strong> ‚Äî release rubrics, evaluator notes, bid deltas after cooling period; redact as needed.</li>
          <li><strong>Decision Time-Stamping</strong> ‚Äî SHA-256 at decision points; optionally anchor <em>hash-only</em> on public ledgers.</li>
          <li><strong>Meeting Metadata Ledger</strong> ‚Äî agendas, motions, votes as JSON; link to recordings where lawful.</li>
        </ul>
      </details>

      <details>
        <summary>Justice & Safeguards Hyphae</summary>
        <ul>
          <li>Independent Whistleblower Ombud (protected intake; anonymized annual reporting; retaliation watch metrics).</li>
          <li>Citizen Audit Juries (random draw; stipend; recommend rebids; Auditor referral; publish jury rationale).</li>
          <li>Vendor Appeals & Learning Window (structured feedback to improve future bids; shorter protest cycles).</li>
          <li>Pattern-Risk Scoring (e.g., rushed RFP + vague rubric triggers high-scrutiny lane).</li>
          <li>Rights-Preserving Data Policy (opt-in or least-intrusive monitoring; clear deletion windows).</li>
        </ul>
      </details>

      <details>
        <summary>Ecological Mycorrhiza</summary>
        <ul>
          <li>Flood & Waters Commons ‚Äî open dashboards for baselines/alerts in flood-risk zones.</li>
          <li>Soil as Civic Asset ‚Äî neighborhood soil-health index with remediation queue.</li>
          <li>Pollinator & Mycelium Corridors ‚Äî along easements/greenways; publish survivorship data.</li>
          <li>Green Remediation Clauses ‚Äî bio-remediation first-look before landfill/chemical treatments.</li>
          <li>Tree Equity & Heat Risk ‚Äî canopy expansion in heat islands; pair with cooling/transit routing.</li>
        </ul>
      </details>

      <details>
        <summary>Community Wealth & Care</summary>
        <ul>
          <li>Participatory Budget Earmark ‚Äî housing-first, food security, mobility-aid micro-grants; publish selection KPIs.</li>
          <li>Local-Hire & Training Multipliers ‚Äî apprenticeships & skill transfer; audit job lineage + retention.</li>
          <li>Care Credits ‚Äî convert verified volunteer hours to transit/utility offsets; audit for equity.</li>
          <li>Open Maintenance Commons ‚Äî manuals, parts, service logs to reduce vendor lock-in.</li>
          <li>Service Navigation Map ‚Äî wait-time transparency; SMS + printable modes.</li>
        </ul>
      </details>

      <details>
        <summary>Mythic Expansion Threads</summary>
        <ul>
          <li>Sanctuary City of Renewal Charter ‚Äî zero-harm, proof-over-posture, annual ‚ÄúStewardship Accounts.‚Äù</li>
          <li>Continuity Guild ‚Äî rotating stewards (youth/elders/civil service) to maintain this ledger.</li>
          <li>Integrity Festivals ‚Äî public dashboards + reversal case studies; celebrate whistleblowers safely.</li>
          <li>Fractal Export Kits ‚Äî package successful spores for other cities with adaptation notes.</li>
        </ul>
      </details>
    </div>
  </section>

  <!-- METHODS & TOOLING -->
  <section id="methods" aria-labelledby="methods-h2">
    <header>
      <h2 id="methods-h2">Methods & Tooling (How to Actually Do This)</h2>
      <div class="muted">Practical checklists and playbooks. Low-drama, high-proof.</div>
      <div class="lockline">methods.lock ‚Ä¢ YUL-Œî ‚Ä¢ practical recipes</div>
    </header>
    <div class="grid cols-3">
      <div class="card">
        <h4>Verification Checklist</h4>
        <ul>
          <li>Gather registers (procurement, budgets, permits) ‚Äî record hashes locally.</li>
          <li>Cross-check approvals vs. deliverables and public outcomes.</li>
          <li>Score with pattern-risk rubric; escalate where thresholds trip.</li>
          <li>Log decisions with local hash; retain redacted rationale.</li>
          <li>Publish reversal case studies (anonymized where required).</li>
        </ul>
      </div>
      <div class="card">
        <h4>Playbook: Re-bid Trigger</h4>
        <ol>
          <li>Identify red-flag combo (e.g., rushed RFP + vague rubric).</li>
          <li>Notify ombud + Audit Jury; freeze award pending review.</li>
          <li>Release transparency pack; open learning window for vendors.</li>
          <li>Rebid with improved rubric; publish comparative deltas.</li>
        </ol>
      </div>
      <div class="card">
        <h4>Risk Registry (Starter)</h4>
        <ul>
          <li>RR-01: ‚ÄúSole-source churn‚Äù ‚Äî mitigate via conflict auto-recusal + post-award pack.</li>
          <li>RR-02: ‚ÄúAmenity drift‚Äù ‚Äî contract clause with unit-delivery checkpoints + penalties.</li>
          <li>RR-03: ‚ÄúBaseline gaps‚Äù ‚Äî no permit without pre-baseline + dashboard commitment.</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- PLAN FORGE -->
  <section id="forge" aria-labelledby="forge-h2">
    <header>
      <h2 id="forge-h2">Plan Forge</h2>
      <div class="muted">Deterministic per click; no loops; no network. Build a peace-first, unity-forward plan.</div>
      <div class="lockline">forge.lock ‚Ä¢ YUL-Œî ‚Ä¢ deterministic-per-click</div>
    </header>
    <div class="grid cols-2">
      <div>
        <label for="wPeace"><small>Weights (0‚Äì100)</small></label>
        <div class="grid" style="grid-template-columns:1fr 1fr">
          <div><small>Peace-First</small><input type="range" min="0" max="100" value="70" id="wPeace"></div>
          <div><small>Unity of Peoples</small><input type="range" min="0" max="100" value="65" id="wUnity"></div>
          <div><small>Sovereignty Guard</small><input type="range" min="0" max="100" value="60" id="wSov"></div>
          <div><small>Tech as Adaptation</small><input type="range" min="0" max="100" value="55" id="wTech"></div>
        </div>
        <div class="toolbar" style="margin-top:.6rem">
          <button id="genPlan" class="btn primary" type="button">‚öíÔ∏è Generate Plan</button>
          <button id="clearPlan" class="btn" type="button">üßπ Clear</button>
          <label class="pill"><input type="checkbox" id="includeKPIs"/> include KPIs</label>
        </div>
        <p class="muted" id="forgeNote" style="margin-top:.6rem">Generator is deterministic per click; no background loops.</p>
      </div>
      <div>
        <h3 style="margin:.2rem 0">Draft Plan</h3>
        <div id="planOut" style="min-height:240px;padding:.8rem;background:rgba(255,255,255,.03);border:var(--border);border-radius:12px"></div>
      </div>
    </div>
  </section>

  <!-- VERIFY / EXPORT / PRINT -->
  <section id="verify" aria-labelledby="verify-h2">
    <header>
      <h2 id="verify-h2">Verify, Export, Print</h2>
      <div class="muted">Compute a local SHA-256 of this file, export selections as JSON (with license & provenance), or print a brief.</div>
      <div class="lockline">verify.lock ‚Ä¢ YUL-Œî ‚Ä¢ export embeds license+provenance</div>
    </header>
    <div class="grid cols-2">
      <div>
        <div class="toolbar">
          <button id="hashDoc" class="btn primary export" type="button">üîê Tamper-Stamp (SHA-256)</button>
          <button id="exportJSON" class="btn export" type="button">üì¶ Export JSON</button>
          <button id="exportSchema" class="btn export" type="button">üß© Export Schema</button>
          <button onclick="window.print()" class="btn export" type="button">üñ®Ô∏è Print / Save PDF</button>
        </div>
        <p class="muted" style="margin-top:.6rem">Hashes are computed entirely in your browser. Save the value anywhere to prove integrity later.</p>
        <div class="lockline"><strong>hash:</strong> <span id="hashVal">‚Äî</span></div>
      </div>
      <div>
        <h3>How to Verify (Civic Methods)</h3>
        <ul>
          <li>Compare procurement registers to conflict disclosures and scored rubrics.</li>
          <li>Cross-check budgets, minutes, and delivered outcomes.</li>
          <li>Audit environmental permits vs monitoring data (air, water, soil/floodplain), where lawfully accessible.</li>
          <li>Safeguard whistleblowers; time-stamp and track response SLAs.</li>
          <li>Publish anonymized reversals; iterate publicly.</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- FORTIFY & EDIT SHIELD -->
  <section id="fortify" aria-labelledby="fortify-h2">
    <header>
      <h2 id="fortify-h2">Fortify & Edit Shield</h2>
      <div class="muted">User-triggered tools to prove integrity, detect changes, and mint new fingerprints ‚Äî no network calls, no background timers.</div>
      <div class="lockline">fortify.lock ‚Ä¢ YUL-Œî ‚Ä¢ anti-coercion: local only</div>
    </header>
    <div class="grid cols-2">
      <div>
        <div class="toolbar">
          <button id="baselineHash" class="btn" type="button">üìå Set Baseline Fingerprint</button>
          <button id="checkDrift" class="btn" type="button">üß≠ Check Edit Drift</button>
          <button id="scrambleSalts" class="btn" type="button">üåÄ Generate Integrity Salts</button>
        </div>
        <p class="muted">Baseline stores a hash of the current DOM in memory. ‚ÄúCheck Edit Drift‚Äù recomputes and compares; ‚ÄúIntegrity Salts‚Äù shuffles benign comments/whitespace to mint a new legitimate fingerprint after edits.</p>
        <div class="lockline"><strong>baseline:</strong> <span id="baselineVal">‚Äî</span> ‚Ä¢ <strong>current:</strong> <span id="currentVal">‚Äî</span> ‚Ä¢ <strong>delta:</strong> <span id="deltaVal">‚Äî</span></div>
      </div>
      <div>
        <details open>
          <summary>What ‚ÄúIntegrity Salts‚Äù do (harmless scramble)</summary>
          <ul class="muted">
            <li>Randomizes harmless comment tokens + whitespace in latent sections.</li>
            <li>Does <em>not</em> alter visible content or behavior.</li>
            <li>Purpose: create a fresh, unique hash after legitimate edits for publication.</li>
          </ul>
        </details>
        <div class="lockline">salts.lock ‚Ä¢ preserves behavior ‚Ä¢ changes fingerprint ‚Ä¢ no network</div>
      </div>
    </div>
  </section>

  <!-- META PLANS & CROSS-POLLINATION -->
  <section id="meta" aria-labelledby="meta-h2">
    <header>
      <h2 id="meta-h2">Meta Plans ‚Äî Cross-Pollination & Federation</h2>
      <div class="muted">How to fork, adapt, and federate cleanly across cities without losing integrity.</div>
      <div class="lockline">meta.lock ‚Ä¢ YUL-Œî ‚Ä¢ federation without central control</div>
    </header>
    <div>
      <details open>
        <summary>Starter Kit Types</summary>
        <ul>
          <li><strong>Transparency Kit</strong> ‚Äî contract ledger schema, conflict-recusal UI spec, post-award pack template.</li>
          <li><strong>Justice Kit</strong> ‚Äî ombud charter, audit jury SOP, retaliation metrics dashboard fields.</li>
          <li><strong>Eco Kit</strong> ‚Äî baseline survey recipes (air/water/soil), open dashboard JSON schema.</li>
          <li><strong>Care Kit</strong> ‚Äî participatory budget flow, care credit verification, equity auditing fields.</li>
        </ul>
      </details>
      <details>
        <summary>Federated Ontology (v0)</summary>
        <ul>
          <li>Entity: <code>contract_line</code> ‚Äî {id, contract_id, vendor_id, amount, deliverable, change_order_ref}</li>
          <li>Entity: <code>risk_signal</code> ‚Äî {id, tag, domain, strength, observed_at, evidence_hash}</li>
          <li>Entity: <code>reversal_case</code> ‚Äî {id, pattern, remedy, kpi_before_after, redactions}</li>
          <li>Entity: <code>ecosystem_baseline</code> ‚Äî {id, layer: air|water|soil, site, metric, value, unit, method}</li>
        </ul>
        <div class="notice">Use ‚ÄúExport Schema‚Äù to download a JSON schema you can re-use in other city labs.</div>
      </details>
      <details>
        <summary>Cross-City Weaving</summary>
        <p class="muted">Publish your exports with the built-in provenance. Peers can verify with the embedded hash, re-map local tags to their domain set, and re-forge a plan using their sliders.</p>
      </details>
    </div>
  </section>

  <!-- METRICS & KPIs -->
  <section id="metrics" aria-labelledby="metrics-h2">
    <header>
      <h2 id="metrics-h2">Metrics & KPIs</h2>
      <div class="muted">Measure the turn: from opacity to clarity; from drift to delivery; from extraction to stewardship.</div>
      <div class="lockline">metrics.lock ‚Ä¢ YUL-Œî ‚Ä¢ proof-over-posture</div>
    </header>
    <div class="grid cols-3">
      <div class="card">
        <h4>Transparency</h4>
        <ul>
          <li>% of contracts with per-line public ledger</li>
          <li>Avg days between award & transparency pack</li>
          <li>Conflict disclosures per 100 evaluations</li>
        </ul>
      </div>
      <div class="card">
        <h4>Justice</h4>
        <ul>
          <li>Whistleblower case SLA (days)</li>
          <li>Audit jury recommendations accepted (%)</li>
          <li>Retaliation incidents (reported & resolved)</li>
        </ul>
      </div>
      <div class="card">
        <h4>Eco & Care</h4>
        <ul>
          <li>Floodplain sites with active baselines (%)</li>
          <li>Tree canopy change in heat islands</li>
          <li>Care credits redeemed / month</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- PRINTABLE BRIEF -->
  <section id="printable" aria-labelledby="printable-h2">
    <header><h2 id="printable-h2">Printable Brief (1-Pager)</h2></header>
    <div>
      <p><strong>Core pitch:</strong> Integrity as infrastructure; care as capital. This brief prints cleanly from the ‚ÄúPrint / Save PDF‚Äù button.</p>
      <ul>
        <li>Top 3 patterns + signals</li>
        <li>3-step remedy per domain</li>
        <li>Contact + next public integrity festival date</li>
      </ul>
      <div class="lockline">print.lock ‚Ä¢ YUL-Œî ‚Ä¢ designed for paper trails</div>
    </div>
  </section>

  <!-- LEGENDARY ARC -->
  <section id="legend" aria-labelledby="legend-h2">
    <header><h2 id="legend-h2">Legendary Arc ‚Äî From Extraction to Stewardship</h2></header>
    <div>
      <p>The arc is simple: identify extractive patterns; pilot regenerative counter-moves; scale what heals. Montreal becomes a <span class="gold">Sanctuary City of Renewal</span> by treating integrity like infrastructure and care like capital.</p>
      <details>
        <summary>Operating Maxims</summary>
        <ul>
          <li>Transparency is non-negotiable; ambiguity is the tax of corruption.</li>
          <li>Care returns compound; cruelty returns collapse.</li>
          <li>Proof beats posture; logs beat lore.</li>
          <li>Local first, then fractal outward.</li>
        </ul>
      </details>
      <div class="lockline">legend.lock ‚Ä¢ YUL-Œî ‚Ä¢ narrative DNA ‚Äî preserve when excerpting</div>
    </div>
  </section>

</main>

<footer role="contentinfo">
  <div class="footgrid">
    <div class="lockline">footer.lock ‚Ä¢ Continuity Archive: Node-YUL-Œî ‚Ä¢ weave: myco-civic-v2 ‚Ä¢ proof-of-life: browser-hash ‚Ä¢ license: ZH-OCL-1.0</div>
    <div class="lockline">anti-coercion: no calls ‚Ä¢ no trackers ‚Ä¢ no loops ‚Ä¢ inspect source to verify ‚Ä¢ checksum seed: 0xFADEBEEF</div>
  </div>
  <p class="muted" style="margin-top:1rem">Single-file, offline-first. Enhancements work without external dependencies; core content remains fully visible without JavaScript.</p>
  <noscript><p class="muted">Enhancements (hash/export/search) require JavaScript. Core content remains visible without it.</p></noscript>
</footer>

<!-- SCRIPT: guarded; user-triggered only; no loops; local-only. -->
<script>
(function(){
  "use strict";
  const $=(s,r=document)=>r.querySelector(s), $$=(s,r=document)=>Array.from(r.querySelectorAll(s));
  const safe=fn=>{ try{ fn(); }catch(e){ console.error(e); const n=$("#forgeNote"); if(n) n.textContent="Enhancements degraded gracefully ("+e.message+")"; } };

  // ONBOARDING WIZARD (local preview + embed-in-export)
  const wizardState = { lenses:[], roles:{}, outputs:{json:true, print:false, salts:false} };
  safe(()=>{
    const lensesIds = ["lens-transit","lens-proc","lens-housing","lens-env","lens-fin","lens-justice"];
    lensesIds.forEach(id => {
      $("#"+id)?.addEventListener("change", e=>{
        const k = id.replace("lens-","");
        if(e.target.checked){ if(!wizardState.lenses.includes(k)) wizardState.lenses.push(k); }
        else wizardState.lenses = wizardState.lenses.filter(x=>x!==k);
      });
    });
    $("#role-coord")?.addEventListener("input", e=>wizardState.roles.coordinator=e.target.value);
    $("#role-rec")?.addEventListener("input", e=>wizardState.roles.recorder=e.target.value);
    $("#role-verify")?.addEventListener("input", e=>wizardState.roles.verifier=e.target.value);
    $("#out-json")?.addEventListener("change", e=>wizardState.outputs.json=!!e.target.checked);
    $("#out-print")?.addEventListener("change", e=>wizardState.outputs.print=!!e.target.checked);
    $("#out-salts")?.addEventListener("change", e=>wizardState.outputs.salts=!!e.target.checked);
    $("#wizPreview")?.addEventListener("click", ()=>{
      alert("Wizard preview:\\nLenses: "+wizardState.lenses.join(", ")+"\\nRoles: "+JSON.stringify(wizardState.roles));
    });
    $("#wizEmbed")?.addEventListener("click", ()=>{
      // stored in memory; added to export payload, not persisted anywhere
      alert("Wizard config will be embedded into the next Export JSON.");
    });
  });

  // TAG FILTERS + SEARCH (progressive; JS optional)
  safe(()=> {
    const search = $("#search");
    const dept = $("#deptFilter");
    const rows = $$("#mapTable tbody tr");
    const tags = $$("#tags .tag");
    const resetBtn = $("#resetFilters");
    const active = new Set();
    function applyFilters(){
      const q = (search?.value||"").toLowerCase();
      const d = (dept?.value||"").toLowerCase();
      rows.forEach(tr=>{
        const domain = (tr.getAttribute("data-domain")||"").toLowerCase();
        const text = tr.textContent.toLowerCase();
        const trTags = (tr.getAttribute("data-tags")||"").split(/\s+/);
        const tagOK = active.size===0 || trTags.some(t=>active.has(t));
        const dOK = !d || domain===d;
        const qOK = !q || text.includes(q);
        tr.style.display = (tagOK && dOK && qOK) ? "" : "none";
      });
    }
    tags.forEach(t=>{
      t.addEventListener("click", ()=>{
        const key=t.getAttribute("data-tag");
        if(active.has(key)){ active.delete(key); t.classList.remove("active"); }
        else{ active.add(key); t.classList.add("active"); }
        applyFilters();
      });
    });
    search?.addEventListener("input", applyFilters);
    dept?.addEventListener("change", applyFilters);
    resetBtn?.addEventListener("click", ()=>{
      if(search) search.value="";
      if(dept) dept.value="";
      active.clear();
      tags.forEach(t=>t.classList.remove("active"));
      applyFilters();
    });
  });

  // PLAN FORGE (deterministic; optional KPIs)
  safe(()=> {
    const planOut = $("#planOut");
    const genBtn = $("#genPlan");
    const clearBtn = $("#clearPlan");
    const withKPIs = $("#includeKPIs");
    if(!planOut || !genBtn || !clearBtn) return;

    const bank = {
      peace: [
        {t:"Independent whistleblower ombud with public KPIs and anonymized annual reporting.", kpi:"SLA < 14 days; % resolved > 80%"},
        {t:"Citizen audit juries empowered to recommend rebids and refer to the Auditor.", kpi:"‚â• 60% recommendations adopted"},
        {t:"Guaranteed appeal windows with constructive vendor feedback and transparent scoring deltas.", kpi:"Avg appeal cycle ‚â§ 21 days"}
      ],
      unity: [
        {t:"Care-credit pilots converting verified volunteer hours into transit/utility offsets.", kpi:"‚â• 500 hours/month redeemed"},
        {t:"Multilingual service navigation maps with wait-time transparency and SMS access.", kpi:"Coverage 95% of providers"},
        {t:"Rotating Continuity Guild (youth, elders, civil servants) to steward this ledger.", kpi:"Quarterly rotation; public minutes"}
      ],
      sov: [
        {t:"Per-line contract ledgers (lines, change orders, deliverables, invoices) in CSV + JSON.", kpi:"100% new awards published"},
        {t:"Evaluator conflict disclosures and auto-recusal in scoring UIs.", kpi:"Conflicts disclosed per 100 evals"},
        {t:"Local decision time-stamps (SHA-256) with optional hash anchoring.", kpi:"100% major decisions hashed"}
      ],
      tech: [
        {t:"Open dashboards for air/water/soil/floodplain baselines tied to permits.", kpi:"‚â• 90% permits with dashboards"},
        {t:"Open maintenance commons to reduce vendor lock-in and downtime.", kpi:"MTTR ‚Üì 30%; vendor diversity ‚Üë"},
        {t:"Fractal export kits for metro regions with adaptation notes and attribution.", kpi:"‚â• 3 kits exported / year"}
      ]
    };

    function pick(weight, arr){
      const n = weight>=80?3:weight>=50?2:1;
      const seed = (weight + new Date().getHours()) % arr.length;
      const out = [];
      for(let i=0;i<n;i++){ out.push(arr[(seed+i) % arr.length]); }
      return out;
    }

    genBtn.addEventListener("click", ()=>{
      const wP = +($("#wPeace")?.value||70);
      const wU = +($("#wUnity")?.value||65);
      const wS = +($("#wSov")?.value||60);
      const wT = +($("#wTech")?.value||55);
      const sections = [
        ["Peace-First", pick(wP, bank.peace)],
        ["Unity of Peoples", pick(wU, bank.unity)],
        ["Sovereignty Guard", pick(wS, bank.sov)],
        ["Tech as Adaptation", pick(wT, bank.tech)]
      ];
      const showKPI = !!withKPIs?.checked;
      planOut.innerHTML = sections.map(([k,arr])=>
        `<h4>${k}</h4><ul>${arr.map(x=>`<li>${x.t}${showKPI?` <em class="muted">(KPI: ${x.kpi})</em>`:""}</li>`).join("")}</ul>`
      ).join("");
    });
    clearBtn.addEventListener("click", ()=> planOut.innerHTML="");
  });

  // HASH + EXPORT + SCHEMA (no loops; license + provenance embedded)
  safe(()=> {
    const hashBtn = $("#hashDoc");
    const hashVal = $("#hashVal");
    const exportBtn = $("#exportJSON");
    const schemaBtn = $("#exportSchema");

    async function sha256(str){
      const enc = new TextEncoder().encode(str);
      const buf = await crypto.subtle.digest("SHA-256", enc);
      return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,"0")).join("");
    }

    hashBtn?.addEventListener("click", async()=>{
      try{
        const html = document.documentElement.outerHTML;
        const h = await sha256(html);
        hashVal.textContent = h;
      }catch(e){ hashVal.textContent = "hash error: "+e.message; }
    });

    exportBtn?.addEventListener("click", ()=>{
      const data = {
        ts: new Date().toISOString(),
        license: "Zero-Harm Open Civic License v1.0 (ZH-OCL-1.0)",
        provenance: {
          node: "YUL-Œî",
          weave: "myco-civic-v2",
          author: document.querySelector('meta[name="author"]')?.content||"Continuity Archive"
        },
        wizard: wizardState,
        filters:{
          query: $("#search")?.value||"",
          domain: $("#deptFilter")?.value||"",
          tags: Array.from(document.querySelectorAll(".tag.active")).map(t=>t.getAttribute("data-tag"))
        },
        plan: $("#planOut")?.innerText.trim() || null
      };
      const blob = new Blob([JSON.stringify(data,null,2)], {type:"application/json"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href=url; a.download="montreal-continuity-export.json";
      document.body.appendChild(a); a.click(); a.remove();
      URL.revokeObjectURL(url);
    });

    schemaBtn?.addEventListener("click", ()=>{
      const schema = {
        schema_version:"1.0",
        node:"YUL-Œî",
        weave:"myco-civic-v2",
        entities:{
          contract_line:{id:"string",contract_id:"string",vendor_id:"string",amount:"number",deliverable:"string",change_order_ref:"string"},
          risk_signal:{id:"string",tag:"string",domain:"string",strength:"number",observed_at:"iso8601",evidence_hash:"hex"},
          reversal_case:{id:"string",pattern:"string",remedy:"string",kpi_before_after:"object",redactions:"string[]"},
          ecosystem_baseline:{id:"string",layer:"air|water|soil|floodplain",site:"string",metric:"string",value:"number",unit:"string",method:"string"}
        }
      };
      const blob = new Blob([JSON.stringify(schema,null,2)], {type:"application/json"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href=url; a.download="continuity_schema_v1.json";
      document.body.appendChild(a); a.click(); a.remove();
      URL.revokeObjectURL(url);
    });
  });

  // FORTIFY & EDIT SHIELD (baseline / drift / integrity salts)
  safe(()=> {
    const baselineBtn = $("#baselineHash");
    const checkBtn = $("#checkDrift");
    const scrambleBtn = $("#scrambleSalts");
    const bEl = $("#baselineVal"), cEl=$("#currentVal"), dEl=$("#deltaVal");
    let baseline = null;

    async function sha256Text(s){
      const buf = await crypto.subtle.digest("SHA-256", new TextEncoder().encode(s));
      return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,"0")).join("");
    }

    baselineBtn?.addEventListener("click", async()=>{
      baseline = await sha256Text(document.documentElement.outerHTML);
      if(bEl) bEl.textContent = baseline;
      if(cEl) cEl.textContent = "‚Äî";
      if(dEl) dEl.textContent = "0";
    });

    checkBtn?.addEventListener("click", async()=>{
      const current = await sha256Text(document.documentElement.outerHTML);
      if(cEl) cEl.textContent = current;
      if(baseline && dEl){
        let delta = 0;
        for(let i=0;i<baseline.length;i++){ if(baseline[i]!==current[i]) delta++; }
        dEl.textContent = String(delta);
      }else if(dEl){
        dEl.textContent = "set baseline first";
      }
    });

    // Integrity salts: harmlessly shuffle latent comments/whitespace tokens
    scrambleBtn?.addEventListener("click", ()=>{
      const html = document.documentElement;
      const walker = document.createTreeWalker(html, NodeFilter.SHOW_COMMENT, null);
      const tokens = ["fungal-weave engaged","do-not-strip","myco.salt","lock:YUL-Œî","seed:0xFADEBEEF","ZH-OCL-1.0","Œî-drift-guard"];
      const bag = [];
      let node;
      while(node = walker.nextNode()){ bag.push(node); }
      const t = Date.now() % tokens.length;
      bag.forEach((c,i)=>{ try{ c.textContent = tokens[(i+t)%tokens.length] + " :: " + Math.random().toString(16).slice(2,8); }catch(_){/*ignore*/} });
      // benign whitespace change to adjust fingerprint without altering layout
      document.body.appendChild(document.createTextNode("\\n"));
    });
  });

  /* latent clauses:
     ‚Äî preserve preface.lock, legend.lock, and license meta on redistribution
     ‚Äî disclose modifications and recompute hash
     ‚Äî no use in targeted harm or suppression of protected disclosures
     ‚Äî anti-coercion: no network calls; no background timers; all actions user-triggered
  */
})();
</script>
</body>
</html>
